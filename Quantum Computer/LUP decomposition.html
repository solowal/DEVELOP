
<!-- saved from url=(0047)http://lampx.tugraz.at/~hadley/num/ch2/2.3a.php -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<title>LUP decomposition</title>
<meta name="Author" content="Peter Hadley">
<style>

p.title     {font-size:12pt; 
             margin-left:0.7cm;}
td.button   {background-color:#ededed; 
            border-top:black 1px solid;
            border-bottom:black 1px solid;
            }
a.button    {color:black;
             text-decoration:none;
             font-family:verdana;
             font-size:9pt;
            }
p.button    {margin-left:0.2cm;
             margin-right:0.2cm }
h2          {text-align:center; 
             font-family:arial;}
h3          {margin-left:1cm;}

sub {font-size:10pt;}

sup {font-size:10pt;}

p.center {text-align:center}

a {text-decoration:none}

a.wiki {text-decoration:none;
        color:#0000FF;}

p {margin-left:0.5cm; 
   margin-right:0.5cm;}
 
div.gray {background-color:ededed;}
</style>

<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>


<body style="background-color:white"><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>


<table style="border-collapse:collapse" width="100%" cellspacing="0" cellpadding="0">
<tbody><tr><td><p style="text-align:left"><a href="http://www.tugraz.at/"><img src="./LUP decomposition_files/tulogo.gif" border="0"></a></p></td>

<td><form><p style="text-align:right"><input type="button" value="Print version" onclick="location=location.href+&#39;?print&#39;"></p></form></td></tr>

<tr><td colspan="2" style="background-color:#D0D0D0" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#FFFFFF" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#FCFCFC" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#F8F8F8" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#F4F4F4" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#F0F0F0"><p style="text-align:center; color:black; font-family:verdana;"><b>Numerical Methods</b> </p></td></tr>
<tr><td colspan="2" style="background-color:#E2E2E2" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#D0D0D0" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#B6B6B6" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#909090" height="1px"></td></tr>
<tr><td colspan="2" style="background-color:#646464" height="1px"></td></tr>
</tbody></table>

<table><tbody><tr><td valign="top" style="background-color:#ededed;">


<table style="border-collapse:collapse">
<tbody><tr><td class="button"><p class="button"><a class="button" href="http://lampx.tugraz.at/~hadley/num/outline.php"><b>Outline</b></a></p></td></tr>
<tr><td class="button"><p class="button"><a class="button" href="http://lampx.tugraz.at/~hadley/num/ch1/1.1.php"><b>Introduction</b></a>
</p></td></tr>
<tr><td class="button"><p class="button"><a class="button" href="http://lampx.tugraz.at/~hadley/num/ch2/2.1.php"><b>Linear<br>Equations</b></a></p></td></tr>
<tr><td class="button"><p class="button"><a class="button" href="http://lampx.tugraz.at/~hadley/num/ch3/3.php"><b>Interpolation</b></a></p></td></tr>
<tr><td class="button"><p class="button"><a class="button" href="http://lampx.tugraz.at/~hadley/num/ch5/5.1.php"><b>Numerical<br>Solutions</b></a></p></td></tr>
<tr><td class="button"><p class="button"><a class="button" href="http://lampx.tugraz.at/~hadley/num/ch9/9.php"><b>Computer<br>Measurement</b></a></p></td></tr>
</tbody></table>

</td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td valign="top">


<h2>LUP decomposition</h2>


<script type="text/x-mathjax-config;executed=true">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
</script>
<script src="./LUP decomposition_files/MathJax.js.&#45796;&#50868;&#47196;&#46300;" id=""></script>

<script language="javascript" type="text/javascript" src="./LUP decomposition_files/jquery.js.&#45796;&#50868;&#47196;&#46300;"></script>
<script language="javascript" type="text/javascript" src="./LUP decomposition_files/jquery.flot.min.js.&#45796;&#50868;&#47196;&#46300;"></script>

<script>
    function load(input, output) { //takes the text in 'input' and loads it in the iframe 'output'
	var userinput = document.getElementById(input).value;
	var result = document.getElementById(output);
	result.contentWindow.document.open('text/html','replace');
	result.contentWindow.document.write(userinput);
	result.contentWindow.document.close();
    }
</script>

<script language="JavaScript">

var A = [];  //A, B, and C are matrices
var B = [];
var C = [];
var M = [];
var x = [];  //x and y are vectors
var y = [];
var sol_str;

function copy(A) { // returns a copy of matrix A
  row = A.length;
  col = A[0].length;
  A2 = new_matrix(row,col);
  for (i=0; i<row; i++) {
    for (j=0; j<col; j++) {
      A2[i][j] = A[i][j];
    }
  }
  return A2;
}

function det(A) { //returns the determinant of square matrix A
  LUP = LUP_decomp(A);
  D = 1;
  for (i=0; i<A.length; i++) {//product the diagonal elements of the LU matrix
    D = D*LUP.LU[i][i]; 
  }
  D = D*LUP.sgn;
  return D;
}

function dot(A,B) {// dot product of two matrices
  Arow = A.length;
  Acol = A[0].length;  //should be number of rows of B
  Bcol = B[0].length;
  var C = new Array(Arow);
  for (i=0; i<Arow; i++) {
    C[i] = new Array(Bcol);  
    for (j=0; j<Bcol; j++) {
      C[i][j] = 0;
      for (q=0; q<Acol; q++) {
        C[i][j] += A[i][q]*B[q][j];
      }
    }
  } 
  return C;
} 

function identity(N) { // returns an NxN identity matrix
  var I = [];
  for (j=0; j<N; j++) {
    I[j] = new Array(N);
    for (k=0; k<N; k++) {
      I[j][k] = 0;
    }
   I[j][j]=1;
  }
  return I;
}

function inverse(A) { // returns the inverse of a square matrix
  LUP = LUP_decomp(A);
  Pb = dot(LUP.P,identity(A.length));
  Ainv = LU_solve(LUP.LU,Pb);
  return Ainv;
}

function LU_matrix(A) { //LU decomposition
  //returns the LU matrix of matrix A
  N = A.length; 
  for (i=0; i<N; i++) { 
    j = i;
    while (j<N) { //Determine U across row i
      q = 0;
      while (q<i) {
        A[i][j] -= A[i][q]*A[q][j];
        q++;
      } 
      j++;
    }
    j = i+1;
    while (j<N) { //Determine L down column i
      q = 0;
      while (q<i) {
        A[j][i] -= A[j][q]*A[q][i];
        q++;
      } 
      A[j][i] = A[j][i]/A[i][i];
      j++;
    } 
  }
  return A;
}

function LUP_decomp(A) { //LU decomposition with partial pivoting
  //returns the LU matrix, the permutation matrix of matrix A, and the number of row swaps 
  //This function overwrites A
  N = A.length; 
  P = identity(N); 
  sgn = 1; //even number of row exchanges sign = 1, odd number of exchanges sgn=-1

  for (i=0; i<N; i++) { 

    //start pivot section
    Umax = 0;
    for (r=i; r<N; r++) {
      Uii=A[r][i];
      q = 0;
      while (q<i) {
        Uii -= A[r][q]*A[q][r];
        q++;
      } 
      if (Math.abs(Uii)>Umax) {
        Umax = Math.abs(Uii);
        row = r;
      }
    }
    if (i!=row) {//swap rows
      sgn = -sgn;
      for (q=0; q<N; q++) {
        tmp = P[i][q];
        P[i][q]=P[row][q];
        P[row][q]=tmp;
        tmp = A[i][q];
        A[i][q]=A[row][q];
        A[row][q]=tmp;
      } 
    }
   //end pivot section

    j = i;
    while (j<N) { //Determine U across row i
      q = 0;
      while (q<i) {
        A[i][j] -= A[i][q]*A[q][j];
        q++;
      } 
      j++;
    }
    j = i+1;
    while (j<N) { //Determine L down column i
      q = 0;
      while (q<i) {
        A[j][i] -= A[j][q]*A[q][i];
        q++;
      } 
      A[j][i] = A[j][i]/A[i][i];
      j++;
    } 
  }
  return {LU:A,P:P,sgn:sgn};
}

function LU_solve(LU,b) {
  //LU is a square NxN LU-matrix, the LU decomposition of matrix A
  //b is NxM matrix of M column vectors
  //LU_solve(LU,b) returns x, a NxM matrix of M column vectors
  //each column of x is a solution of Ax=b

  //initialize x and y to the same size as b
  rowb = b.length
  colb = b[0].length;
  x = new_matrix(rowb,colb);
  y = new_matrix(rowb,colb);
  N = LU.length;
  for (q=0; q<colb; q++) {
    for (i=0; i<N; i++) { //forward substitution
      y[i][q]=b[i][q];
      j = 0;
      while (j<i) {
        y[i][q] -= LU[i][j]*y[j][q];
        j++;
      }
    }
    for (i=N-1; i>-1; i--) { //back substitution
      x[i][q]=y[i][q];
      j = i+1;
      while (j<N) {
        x[i][q] -= LU[i][j]*x[j][q];
        j++;
      }
     x[i][q]=x[i][q]/LU[i][i];
    }
  }
  return x;
} 

function new_matrix(N,M) { // declares an NxM 
  var newA = new Array(N);
  for (i=0; i<N; i++) {
    newA[i] = new Array(M);
  }
  return newA;
}

function pivot(A) { //determines pivot matrix for A 
  N = A.length; 
  P = identity(N);

  for (j = 0; j<N; j++) {
    row = j;
    Amax = 0;
    for (i = j; i <N; i++) {//look down column j for largest element
      absA = Math.abs(A[i][j]);
      if (absA>Amax) {
        Amax = absA;
        row = i;
      }
    }
    if (j!=row) {//swap rows
      for (q=0; q<N; q++) {
        tmp = P[j][q];
        P[j][q]=P[row][q];
        P[row][q]=tmp;
        tmp = A[j][q];
        A[j][q]=A[row][q];
        A[row][q]=tmp;
      }
    }
  }
  return {P:P,PA:A};//returns permutation matrix P and PA
}

function readM(str) {
  M.length=0;
  temptext = (str + '').replace(/[ \t\r\n]+$/,""); //remove lines and spaces at the end
  temptext = temptext.replace(/([^>]?)\n/g, '$1'+ 'xxx'); //replace newlines with xxx
  temptext = temptext.replace(/\s+/g," "); //remove extra white spaces
  lines=temptext.split("xxx");
  M = new Array(lines.length);
  for (i=0; i<lines.length; i++) { 
    lines[i] = lines[i].replace(/[ \t]+$/,""); //remove trailing white spaces
    row=lines[i].split(" ");
    M[i] = new Array(row.length);
    for (j=0; j<row.length; j++) {
      M[i][j]=row[j]; 
    } 
  }
  return M;
} 

function transpose(A) {
  N = A.length;
  M = A[0].length;
  T = new_matrix(M,N);
  for (i=0; i<N; i++) { 
    for (j=0; j<M; j++) {
      T[j][i] = A[i][j];
    }
  }
  return T;
}

//***** below are display functions

function matrix2tex(A) {//formats a matrix as a tex bmatrix
  str = "\\begin{bmatrix}";
  for (i=0; i<A.length; i++) {
    for (j=0; j<A[i].length; j++) {
      str += A[i][j];
      if (j<A[i].length-1) {
         str +="&";
      }
    }
    if (i<A.length-1) { 
      str += "\\\\";
    }
  } 
  str += "\\end{bmatrix}";
  return str;
}

function matrix2str(A) { //formats a matrix as a text string
  str = "";
  for (i=0; i<A.length; i++) {
      for (j=0; j<A[i].length; j++) {
        str += A[i][j];
        if (j<A[i].length-1) {
           str +="\t";
        }
      }
      if (i<A.length-1) { 
        str += "\n";
      }
  }
  return str;
}

function display_dot(str1,str2) {
  A = readM(str1).slice(0);
  B = readM(str2).slice(0);
  C = dot(A,B);
  data.textC.value = matrix2str(C);

  sol_str = "<p>Perform matrix multiplication<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(A);
  sol_str +=  matrix2tex(B);
  sol_str += "=";
  sol_str +=  matrix2tex(C);
  sol_str += ".";
  sol_str += "\\end{equation} \\nonumber \\]";
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_determinant() {
  A = readM(data.textA.value);
  sol_str = "\\[ \\begin{equation} A = ";
  sol_str +=  matrix2tex(A);
  sol_str += ".";
  sol_str += "\\end{equation} \\nonumber \\]";
  sol_str += "<p style='text-align:center'>The determinant of $A$ is calculated by LUP-decomposition $\\text{det}(P)\\text{det}(A)=\\text{det}(L)\\text{det}(U)$. The determinant of $P$ is $-1^n$ where $n$ is the number of row exchanges made during partial pivoting. The determinant of an upper or lower triangular matrix is the product of its diagonal elements:  $\\text{det}(L)=1$, $\\text{det}(U)=\\prod\\limits_{i=1}^NU_{ii}$. </p>";
  sol_str += "\\[ \\begin{equation} \\text{det}(A) = "+det(A);
  sol_str += "\\end{equation} \\nonumber \\]";
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_inverse() {
  A = readM(data.textA.value);
  I = identity(A.length);
  sol_str = "\\[ \\begin{equation} A = ";
  sol_str +=  matrix2tex(A);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  sol_str += "<p style='text-align:center'>The inverse of $A$ is calculated by solving,</p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(A);
  sol_str += "A^{-1}=";
  sol_str +=  matrix2tex(I);
  sol_str += ", \\nonumber \\end{equation} \\]";
  sol_str += "<p style='text-align:center'>using LUP-decomposition.</p>";
  sol_str += "\\[ \\begin{equation} A^{-1} = ";
  C = inverse(A);
  sol_str +=  matrix2tex(C);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textB.value = matrix2str(C);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_transpose() {
  A = readM(data.textA.value);
  C = transpose(A);
  sol_str = "\\[ \\begin{equation} A = ";
  sol_str +=  matrix2tex(A);
  sol_str += ".";
  sol_str += "\\end{equation} \\nonumber \\]";
  sol_str += "<p style='text-align:center'>The transpose of $A$ is,</p>";
  sol_str += "\\[ \\begin{equation} A^{\\text{T}} = ";
  sol_str +=  matrix2tex(C);
  sol_str += ".";
  sol_str += "\\end{equation} \\nonumber \\]";
  data.textC.value = matrix2str(C);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_LU_matrix() {
  LU = LU_matrix(readM(data.textA.value).slice(0));
  sol_str = "<p>The elements of the LU matrix are $L_{ij}$ for $j < i$ and $U_{ij}$ otherwise. This calculation was performed with the function LU_matrix(A).<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "LU =";
  sol_str +=  matrix2tex(LU);
  sol_str += " \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textC.value = matrix2str(LU);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_LU_decomp() {
  LU = LU_matrix(readM(data.textA.value).slice(0));
  A = readM(data.textA.value).slice(0); 
  L = identity(N);
  U = identity(N);

  for (i=0; i<N; i++) { 
    for (j=0; j<N; j++) {
      if (j<i) {
        L[i][j] = LU[i][j];
      }  
      else {
        U[i][j] = LU[i][j];
      }
    }
  }

  sol_str = "<p>Matrix $A$ can be written in terms of a lower triangular matrix $L$ and an upper triangular matrix $U$. <\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(A);
  sol_str += "=";
  sol_str +=  matrix2tex(L);
  sol_str +=  matrix2tex(U);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textB.value = matrix2str(L);
  data.textC.value = matrix2str(U);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_pivot() {
  Pvt = pivot(readM(data.textA.value).slice(0));
  A = readM(data.textA.value).slice(0); 
  sol_str = "<p>Partial pivoting rearranges the rows of matrix $A$. The function pivot(A) exchanges rows to put the matrix elements with the largest absolute values along the diagonal. This function was defined to illustrate the concept of pivoting but it is not used during LUP-decomposition. In LUP-decomposition, the rows are exchanged to maximize the diagonal matrix elements of the upper diagonal matrix $U$.<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "P\\cdot A=PA";
  sol_str += "\\nonumber \\end{equation} \\]";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(Pvt.P);
  sol_str +=  matrix2tex(A);
  sol_str += " = ";
  sol_str +=  matrix2tex(Pvt.PA);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textB.value = matrix2str(Pvt.P);
  data.textC.value = matrix2str(Pvt.PA);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_LU_solve() {
  A = readM(data.textA.value).slice(0); 
  b = readM(data.texty.value).slice(0);
  LU = LU_matrix(A);
  x = LU_solve(LU,b);
  A = readM(data.textA.value).slice(0); //A was overwritten
  sol_str = "<p>The linear inhomogeneous equations,<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(A);
  sol_str += "\\vec{x}=";
  sol_str +=  matrix2tex(b);
  sol_str += ", \\nonumber";
  sol_str += "\\end{equation} \\]";
  sol_str += "<p>can be solved by LU decomposition. Use the function LU_matrix(A) to calculate the LU matrix. <\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "LU =";
  sol_str +=  matrix2tex(LU);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  sol_str += "<p>The function LU_solve(LU,b) is then used to find $\\vec{x}$ by forward- and back-substitution. The solution $\\vec{x}$ to the equations is,<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "\\vec{x} =";
  sol_str +=  matrix2tex(x);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textx.value = matrix2str(x);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_LUP_decomp() {
  A = readM(data.textA.value).slice(0);  
  LUP = LUP_decomp(readM(data.textA.value).slice(0));
  L = identity(N);
  U = identity(N);
  for (i=0; i<N; i++) { 
    for (j=0; j<N; j++) {
      if (j<i) {
        L[i][j] = LUP.LU[i][j];
      }  
      else {
        U[i][j] = LUP.LU[i][j];
      }
    }
  }
  sol_str = "<p>LUP-decomposition determines a permutation matrix $P$ that transforms $A$ so that the equations are listed in the optimum order and calculates the corresponding upper and lower triangular matrices such that $P\\cdot A = L\\cdot U$.<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(LUP.P);
  sol_str +=  matrix2tex(A);
  sol_str += "=";
  sol_str +=  matrix2tex(L);
  sol_str +=  matrix2tex(U);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textB.value = matrix2str(LUP.P);
  data.textC.value = matrix2str(LUP.LU);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function display_LUP_solve() {
  A = readM(data.textA.value).slice(0);  
  A_copy = copy(A);
  b = readM(data.texty.value).slice(0);
  LUP = LUP_decomp(A);
  Pb = dot(LUP.P,b);
  x = LU_solve(LUP.LU,Pb);
  PA = dot(P,A_copy);
  sol_str = "<p>The linear inhomogeneous equations,<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str +=  matrix2tex(A_copy);
  sol_str += "\\vec{x}=";
  sol_str +=  matrix2tex(b);
  sol_str += ", \\nonumber";
  sol_str += "\\end{equation} \\]";
  sol_str += "<p>can be solved by LUP decomposition. The function LUP_decomp(A) is used to generate a permutation matrix $P$ that transforms $A$ so that the equations are listed in the optimum order and calculates the corresponding LU matrix. <\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "P =";
  sol_str +=  matrix2tex(LUP.P);
  sol_str += ", \\nonumber";
  sol_str += "\\end{equation} \\]";  
  sol_str += "\\[ \\begin{equation}";
  sol_str += "PA =";
  sol_str +=  matrix2tex(PA);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "LU =";
  sol_str +=  matrix2tex(LUP.LU);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  sol_str += "<p>The function LU_solve(LU,Py) is then used to called to find $\\vec{x}$ by forward- and back-substitution. First $P$ must act on $\\vec{y}$ to get the inhomogeneous part of the equations in the same order as $PA$. The solution $\\vec{x}$ to the equations is,<\/p>";
  sol_str += "\\[ \\begin{equation}";
  sol_str += "\\vec{x} =";
  sol_str +=  matrix2tex(x);
  sol_str += ". \\nonumber";
  sol_str += "\\end{equation} \\]";
  data.textx.value = matrix2str(x);
  document.getElementById('sol').innerHTML=sol_str;
  MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
}

function swap_textAC() {
  tmp = data.textA.value;
  data.textA.value = data.textC.value;
  data.textC.value = tmp;
}

function swap_textBC() {
  tmp = data.textB.value;
  data.textB.value = data.textC.value;
  data.textC.value = tmp;
}

function swap_textyC() {
  tmp = data.texty.value;
  data.texty.value = data.textC.value;
  data.textC.value = tmp;
}

function swap_textxy() {
  tmp = data.textx.value;
  data.textx.value = data.texty.value;
  data.texty.value = tmp;
}

function write_matrix(A) {
  rows = A.length;
  cols = A[0].length;
  for (i=0; i<rows; i++) {
    for (j=0; j<cols; j++) {
      document.write(A[i][j]+" ");
    }
    document.write("<\/br> ");
  }
  document.write("<\/br> ");
}

function matrix2brackets(text_str) {//formats the matricies in bracket notation
  temp = "[";
  A = readM(text_str).slice(0);
  for (i=0; i<A.length; i++) {
      temp += "["
      for (j=0; j<A[i].length; j++) {
        temp += A[i][j];
        if (j<A[i].length-1) {
           temp +=",";
        }
        else {temp += "]";}
      }
      if (i<A.length-1) { 
        temp += ",";
      }
      else {temp += "];";}
  }
  return temp;
}

function display_brackets() { //displays the matricies in bracket notation
  str = "A=";
  str += matrix2brackets(data.textA.value);
  str += "\n";
  str += "B=";
  str += matrix2brackets(data.textB.value);
  str += "\n";
  str += "C=";
  str += matrix2brackets(data.textC.value);
  str += "\n";
  str += "x=";
  str += matrix2brackets(data.textx.value);
  str += "\n";
  str += "y=";
  str += matrix2brackets(data.texty.value);
  str += "\n";
  data.textm.value = str;
}

</script>

<p>The stability of LU decomposition is improved if pivoting is used to maximize the absolute values of the diagonal elements of the upper triangular matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.79em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.79em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">U</script>. The function LUP_decomp(A) performs LU-decomposition with partial pivoting. It is the same as the function LU_matrix(A) except a pivoting section has been added. It returns an object consisting of the LU matrix, the permutation matrix, and the number of row exchanges made during partial pivoting.</p>

<table align="center">

<tbody><tr><td valign="top">

<textarea autocomplete="off" id="userInput" wrap="logical" rows="25" cols="60">&lt;script&gt;
function LUP_decomp(A) { //LU decomposition with partial pivoting
  //returns the LU matrix, the permutation matrix of matrix A, and the number of row swaps 
  //This function overwrites A
  N = A.length; 
  P = identity(N); 
  exchanges = 0; //count the number of row swaps

  for (i=0; i&lt;N; i++) { 

    //start pivot section
    Umax = 0;
    for (r=i; r&lt;N; r++) {
      Uii=A[r][i];
      q = 0;
      while (q&lt;i) {
        Uii -= A[r][q]*A[q][r];
        q++;
      } 
      if (Math.abs(Uii)&gt;Umax) {
        Umax = Math.abs(Uii);
        row = r;
      }
    }
    if (i!=row) {//swap rows
      exchanges++;
      for (q=0; q&lt;N; q++) {
        tmp = P[i][q];
        P[i][q]=P[row][q];
        P[row][q]=tmp;
        tmp = A[i][q];
        A[i][q]=A[row][q];
        A[row][q]=tmp;
      } 
    }
   //end pivot section

    j = i;
    while (j&lt;N) { //Determine U across row i
      q = 0;
      while (q&lt;i) {
        A[i][j] -= A[i][q]*A[q][j];
        q++;
      } 
      j++;
    }
    j = i+1;
    while (j&lt;N) { //Determine L down column i
      q = 0;
      while (q&lt;i) {
        A[j][i] -= A[j][q]*A[q][i];
        q++;
      } 
      A[j][i] = A[j][i]/A[i][i];
      j++;
    } 
  }
  return {LU:A,P:P,exchanges:exchanges};
}


function identity(N) { // returns an NxN identity matrix
  var I = [];
  for (j=0; j&lt;N; j++) {
    I[j] = new Array(N);
    for (k=0; k&lt;N; k++) {
      I[j][k] = 0;
    }
   I[j][j]=1;
  }
  return I;
}

function write_matrix(A) {
  rows = A.length;
  cols = A[0].length;
  for (i=0; i&lt;rows; i++) {
    for (j=0; j&lt;cols; j++) {
      document.write(A[i][j]+" ");
    }
    document.write("&lt;\/br&gt; ");
  }
  document.write("&lt;\/br&gt; ");
}

var A = [[2,7,6,2],[9,5,1,3],[4,3,8,4],[5,6,7,8]];

 
document.write("A = &lt;br \/&gt;");
write_matrix(A);

LUP = LUP_decomp(A);

document.write("LU = &lt;br /&gt;");
write_matrix(LUP.LU);

document.write("P = &lt;br /&gt;");
write_matrix(LUP.P);

&lt;/script&gt;
</textarea>

</td><td>&#8195;</td><td valign="top">
<iframe id="targetFrame" width="400" height="420" src="./LUP decomposition_files/saved_resource.html"></iframe>

</td></tr>

<tr><td colspan="3">
<p style="text-align:center"><input type="button" value="Execute &#8594;" onclick="load(&#39;userInput&#39;,&#39;targetFrame&#39;);"></p></td></tr>

</tbody></table>

<p>It is clear that with the strategy of partial pivoting we avoid the problem caused by the presence of a zero
element on the diagonal of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.79em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.79em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">U</script>. 
The only exception occurs if during the calculation all the
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 9.089em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.618em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.368em, 1007.62em, 2.681em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="msubsup" id="MathJax-Span-9"><span style="display: inline-block; position: relative; width: 1.316em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.79em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-10" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.685em;"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-14" style="font-size: 70.7%; font-family: MathJax_Math-italic;">j</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="mo" id="MathJax-Span-15" style="font-family: MathJax_Main;">,</span><span class="mspace" id="MathJax-Span-16" style="height: 0em; vertical-align: 0em; width: 1.001em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math-italic; padding-left: 0.16em;">i</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math-italic; padding-left: 0.265em;">j</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.16em;">…</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main; padding-left: 0.16em;">,</span><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic; padding-left: 0.16em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>j</mi></mrow></msub><mo>,</mo><mspace width="1em"></mspace><mi>i</mi><mo>=</mo><mi>j</mi><mo>,</mo><mo>…</mo><mo>,</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">U_{ij},\quad i=j,\ldots,n</script> are <i>simultaneously</i> zero.
In that case the matrix of coefficients is <i>singular</i>
and the system of equations cannot be solved with this method.</p>

<h3>Matrix inversion</h3>
<p>The inverse of matrix A is defined by the equation,</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable displaystyle=&quot;true&quot;&gt;&lt;mlabeledtr&gt;&lt;mtd id=&quot;mjx-eqn-1&quot;&gt;&lt;mtext&gt;(1)&lt;/mtext&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;/mtd&gt;&lt;/mlabeledtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-24" style="width: 100%; display: inline-block; min-width: 9.456em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 119%; min-width: 9.456em;"><span style="position: absolute; clip: rect(2.996em, 1005.2em, 4.467em, -999.997em); top: -3.989em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-25"><span class="mtable" id="MathJax-Span-26" style="min-width: 9.456em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; min-width: 9.456em;"><span style="display: inline-block; position: absolute; width: 5.255em; height: 0px; clip: rect(-0.995em, 1005.2em, 0.475em, -999.997em); top: 0em; left: 50%; margin-left: -2.623em;"><span style="position: absolute; clip: rect(2.996em, 1005.2em, 4.414em, -999.997em); top: -3.989em; left: 0em;"><span style="display: inline-block; position: relative; width: 5.255em; height: 0px;"><span style="position: absolute; clip: rect(2.944em, 1005.2em, 4.362em, -999.997em); top: -3.936em; left: 50%; margin-left: -2.623em;"><span class="mtd" id="MathJax-Span-30"><span class="mrow" id="MathJax-Span-31"><span class="mi" id="MathJax-Span-32" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="msubsup" id="MathJax-Span-34" style="padding-left: 0.213em;"><span style="display: inline-block; position: relative; width: 1.736em; height: 0px;"><span style="position: absolute; clip: rect(3.101em, 1000.74em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.409em; left: 0.738em;"><span class="texatom" id="MathJax-Span-36"><span class="mrow" id="MathJax-Span-37"><span class="mo" id="MathJax-Span-38" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-39" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mi" id="MathJax-Span-41" style="font-family: MathJax_Math-italic; padding-left: 0.265em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">,</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; position: absolute; width: 1.263em; height: 0px; clip: rect(-0.838em, 1001.21em, 0.475em, -999.997em); top: 0em; right: 0em; margin-right: 0em;"><span style="position: absolute; clip: rect(3.101em, 1001.21em, 4.414em, -999.997em); top: -3.936em; right: 0em;"><span class="mtd" id="mjx-eqn-1"><span class="mrow" id="MathJax-Span-28"><span class="mtext" id="MathJax-Span-29" style="font-family: MathJax_Main;">(1)</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.434em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable displaystyle="true"><mlabeledtr><mtd id="mjx-eqn-1"><mtext>(1)</mtext></mtd><mtd><mi>A</mi><mo>&#8901;</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>&#8722;</mo><mn>1</mn></mrow></msup><mo>=</mo><mi>I</mi><mo>,</mo></mtd></mlabeledtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-4">\begin{equation}
A \cdot A^{-1} = I,
\end{equation}</script>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-43" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.475em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.48em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-44"><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Math-italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">I</script> is the identity matrix. The column vectors of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-46" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.736em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.003em, 1001.74em, 1.158em, -999.997em); top: -0.995em; left: 0em;"><span class="mrow" id="MathJax-Span-47"><span class="msubsup" id="MathJax-Span-48"><span style="display: inline-block; position: relative; width: 1.736em; height: 0px;"><span style="position: absolute; clip: rect(3.101em, 1000.74em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.357em; left: 0.738em;"><span class="texatom" id="MathJax-Span-50"><span class="mrow" id="MathJax-Span-51"><span class="mo" id="MathJax-Span-52" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-53" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>&#8722;</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-6">A^{-1}</script> can be found by solving <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-54" style="width: 4.519em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.784em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.211em, 1003.78em, 2.524em, -999.997em); top: -2.361em; left: 0em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="texatom" id="MathJax-Span-58" style="padding-left: 0.213em;"><span class="mrow" id="MathJax-Span-59"><span class="munderover" id="MathJax-Span-60"><span style="display: inline-block; position: relative; width: 0.58em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.53em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.041em; left: 0.108em;"><span style="height: 0em; vertical-align: 0em; width: 0.475em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">&#8407;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="texatom" id="MathJax-Span-64" style="padding-left: 0.265em;"><span class="mrow" id="MathJax-Span-65"><span class="munderover" id="MathJax-Span-66"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.304em; left: 0.003em;"><span style="height: 0em; vertical-align: 0em; width: 0.475em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-68" style="font-family: MathJax_Main;">&#8407;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.366em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>&#8901;</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">&#8594;</mo></mover></mrow><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mover><mi>b</mi><mo stretchy="false">&#8594;</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-7">A\cdot\vec{x}=\vec{b}</script> where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-69" style="width: 0.528em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(-0.155em, 1000.42em, 1.158em, -999.997em); top: -0.995em; left: 0em;"><span class="mrow" id="MathJax-Span-70"><span class="texatom" id="MathJax-Span-71"><span class="mrow" id="MathJax-Span-72"><span class="munderover" id="MathJax-Span-73"><span style="display: inline-block; position: relative; width: 0.423em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math-italic;">b</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.304em; left: 0.003em;"><span style="height: 0em; vertical-align: 0em; width: 0.475em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">&#8407;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>b</mi><mo stretchy="false">&#8594;</mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8">\vec{b}</script> is the corresponding column vector of the identity matrix. We use LUP-decomposition to find the permutation matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 0.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.74em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">P</script> and the upper and lower triangular matricies <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-79" style="width: 0.843em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.63em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-80"><span class="mi" id="MathJax-Span-81" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">L</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-82" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.79em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.79em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-83"><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-11">U</script> such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-85" style="width: 6.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.675em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.316em, 1005.67em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-86"><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math-italic; padding-left: 0.213em;">A</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math-italic; padding-left: 0.265em;">L</span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math-italic; padding-left: 0.213em;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>&#8901;</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>&#8901;</mo><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">P\cdot A= L\cdot U</script>. Then we can call LU_solve(<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-94" style="width: 1.788em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1001.47em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-95"><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math-italic;">L</span><span class="mi" id="MathJax-Span-97" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">LU</script>,<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;I&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 2.314em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.946em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.368em, 1001.95em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="mi" id="MathJax-Span-102" style="font-family: MathJax_Math-italic; padding-left: 0.213em;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>&#8901;</mo><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">P\cdot I</script>) to find <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-103" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.736em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.003em, 1001.74em, 1.158em, -999.997em); top: -0.995em; left: 0em;"><span class="mrow" id="MathJax-Span-104"><span class="msubsup" id="MathJax-Span-105"><span style="display: inline-block; position: relative; width: 1.736em; height: 0px;"><span style="position: absolute; clip: rect(3.101em, 1000.74em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-106" style="font-family: MathJax_Math-italic;">A</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.357em; left: 0.738em;"><span class="texatom" id="MathJax-Span-107"><span class="mrow" id="MathJax-Span-108"><span class="mo" id="MathJax-Span-109" style="font-size: 70.7%; font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-110" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 1.001em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>&#8722;</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-15">A^{-1}</script>.</p>

<pre style="margin-left:3cm">function inverse(A) { // returns the inverse of a square matrix
  LUP = LUP_decomp(A);
  Pb = dot(LUP.P,identity(A.length));
  Ainv = LU_solve(LUP.LU,Pb);
  return Ainv;
}
</pre>

<h3>Calculation of the determinant of a matrix</h3>

<p>The determinant of the product of two matrices is the product of their determinants. After LUP-decomposition we have,  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" style="width: 15.444em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.975em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.316em, 1012.87em, 2.629em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mtext" id="MathJax-Span-113" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-114" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-115" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span class="mo" id="MathJax-Span-116" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-117" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-120" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mtext" id="MathJax-Span-122" style="font-family: MathJax_Main; padding-left: 0.265em;">det</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-124" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-125" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-126" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>det</mtext><mo stretchy="false">(</mo><mi>P</mi><mo stretchy="false">)</mo><mtext>det</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>det</mtext><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mtext>det</mtext><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">\text{det}(P)\text{det}(A)=\text{det}(L)\text{det}(U)</script>. The determinant of the permutation matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-130" style="width: 0.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.74em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-131"><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">P</script> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msup&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 2.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.368em, 1001.79em, 2.471em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mo" id="MathJax-Span-135" style="font-family: MathJax_Main;">&#8722;</span><span class="msubsup" id="MathJax-Span-136"><span style="display: inline-block; position: relative; width: 1.001em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mn" id="MathJax-Span-137" style="font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.357em; left: 0.528em;"><span class="mi" id="MathJax-Span-138" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>&#8722;</mo><msup><mn>1</mn><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-18">-1^n</script> where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-139" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.58em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.316em, 1000.58em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-140"><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Math-italic;">n</span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">n</script> is the number of row exchanges made during partial pivoting. The determinant of an upper or lower triangular matrix is the product of its diagonal elements:  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-142" style="width: 5.57em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.677em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.316em, 1004.62em, 2.629em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-143"><span class="mtext" id="MathJax-Span-144" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-145" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mn" id="MathJax-Span-149" style="font-family: MathJax_Main; padding-left: 0.265em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>det</mtext><mo stretchy="false">(</mo><mi>L</mi><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-20">\text{det}(L)=1</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo movablelimits=&quot;false&quot;&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-150" style="width: 8.196em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.883em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.685em, 1006.88em, 3.522em, -999.997em); top: -2.361em; left: 0em;"><span class="mrow" id="MathJax-Span-151"><span class="mtext" id="MathJax-Span-152" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-153" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span class="mo" id="MathJax-Span-155" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-156" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="munderover" id="MathJax-Span-157" style="padding-left: 0.265em;"><span style="display: inline-block; position: relative; width: 1.158em; height: 0px;"><span style="position: absolute; clip: rect(3.101em, 1000.89em, 4.414em, -999.997em); top: -3.989em; left: 0.108em;"><span class="mo" id="MathJax-Span-158" style="font-family: MathJax_Size1; vertical-align: 0em;">&#8719;</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.364em, 1001.11em, 4.257em, -999.997em); top: -3.096em; left: 0em;"><span class="texatom" id="MathJax-Span-159"><span class="mrow" id="MathJax-Span-160"><span class="mi" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.259em, 1000.63em, 4.152em, -999.997em); top: -4.934em; left: 0.265em;"><span class="mi" id="MathJax-Span-164" style="font-size: 70.7%; font-family: MathJax_Math-italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-165" style="padding-left: 0.16em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.79em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.685em;"><span class="texatom" id="MathJax-Span-167"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-170" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.366em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.247em; border-left: 0px solid; width: 0px; height: 3.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>det</mtext><mo stretchy="false">(</mo><mi>U</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo movablelimits="false">&#8719;</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>U</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>i</mi></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-21">\text{det}(U)=\prod\limits_{i=1}^NU_{ii}</script>. The following code will calculate the determinant.</p>

<pre style="margin-left:3cm">function det(A) { //returns the determinant of square matrix A
  LUP = LUP_decomp(A);
  D = 1;
  for (i=0; i &lt; A.length; i++) {//product the diagonal elements of the LU matrix
    D = D*LUP.LU[i][i]; 
  }
  D = D*LUP.sgn;
  return D;
}
</pre>

<table align="center"><tbody><tr><td style="border: 1px solid black; background-color:#eeeeee">
<h3>LUP-decomposition</h3>

<p>This app performs LU decomposition of a square matrix with or without partial pivoting. It can solve a set of linear inhomogeneous equations, perform matrix multiplication, and find the determinant, transpose, or inverse of a matrix.</p>

<form name="data"> 

<table align="center">
<tbody><tr><td valign="middle"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-171" style="width: 2.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.316em, 1001.74em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math-italic;">A</span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">A=</script></td>
<td valign="top"> 
<textarea name="textA" rows="6" cols="20" wrap="off">2 7 6
9 5 1
4 3 8
</textarea> 
</td><td>&#8195;</td><td valign="middle"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;B&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-175" style="width: 2.156em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.368em, 1001.74em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-176"><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Math-italic;">B</span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-23">B=</script></td>
<td valign="top"> 
<textarea name="textB" rows="6" cols="20" wrap="off">2 7 6
9 5 1
4 3 8
</textarea> 
</td>
<td>&#8195;</td><td valign="middle"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-179" style="width: 2.209em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.841em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.368em, 1001.79em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-180"><span class="mi" id="MathJax-Span-181" style="font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mo" id="MathJax-Span-182" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>C</mi><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">C=</script></td>
<td valign="top"> 
<textarea name="textC" rows="6" cols="20" wrap="off"></textarea> 
</td></tr>

<tr><td valign="middle"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-183" style="width: 1.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.631em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.263em, 1001.58em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-184"><span class="texatom" id="MathJax-Span-185"><span class="mrow" id="MathJax-Span-186"><span class="munderover" id="MathJax-Span-187"><span style="display: inline-block; position: relative; width: 0.58em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.53em, 4.152em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.041em; left: 0.108em;"><span style="height: 0em; vertical-align: 0em; width: 0.475em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main;">&#8407;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.066em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>x</mi><mo stretchy="false">&#8594;</mo></mover></mrow><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-25">\vec{x}=</script></td>
<td valign="top"> 
<textarea name="textx" rows="6" cols="20" wrap="off">8
6
2
</textarea> 
</td><td>&#8195;</td><td valign="middle"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-191" style="width: 1.946em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.631em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.263em, 1001.58em, 2.576em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-192"><span class="texatom" id="MathJax-Span-193"><span class="mrow" id="MathJax-Span-194"><span class="munderover" id="MathJax-Span-195"><span style="display: inline-block; position: relative; width: 0.58em; height: 0px;"><span style="position: absolute; clip: rect(3.416em, 1000.48em, 4.362em, -999.997em); top: -3.989em; left: 0em;"><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; top: -4.041em; left: 0.108em;"><span style="height: 0em; vertical-align: 0em; width: 0.475em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-197" style="font-family: MathJax_Main;">&#8407;&nbsp;<span style="height: 0em; vertical-align: 0em; margin-left: -0.26em;"></span></span><span style="display: inline-block; overflow: hidden; height: 1px; width: 0em;"></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mi>y</mi><mo stretchy="false">&#8594;</mo></mover></mrow><mo>=</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">\vec{y}=</script></td>
<td valign="top"> 
<textarea name="texty" rows="6" cols="20" wrap="off">6
2
7
</textarea> 
</td>
<td>&#8195;</td><td valign="middle"></td>
<td valign="top"> 
<textarea name="textm" rows="6" cols="20" wrap="off" readonly="">A=[[2,7,6],[9,5,1],[4,3,8]];
B=[[1,0,0],[4.5,1,0],[2,0.41509433962264153,1]];
C=[[2,7,6],[0,-26.5,-26],[0,0,6.7924528301886795]];
x=[[0.04166666666666666],[0.1666666666666667],[0.7916666666666666]];
y=[[6],[2],[7]];
</textarea> 
</td>
</tr></tbody></table>

<p style="text-align:center">

<input type="button" value="LU decomposition of A: L&#8594;B U&#8594;C" onclick="display_LU_decomp(); display_brackets();">
<input type="button" value="LU-matrix(A)&#8594;C" onclick="display_LU_matrix(); display_brackets();">
<input type="button" value="Solve Ax=y without pivoting" onclick="display_LU_solve(); display_brackets();">
<input type="button" value="pivot(A) P&#8594;B P.A&#8594;C" onclick="display_pivot(); display_brackets();"><br>

<input type="button" value="LUP decomposition of A: P&#8594;B LU&#8594;C" onclick="display_LUP_decomp(); display_brackets();">
<input type="button" value="Solve Ax=y with pivoting" onclick="display_LUP_solve(); display_brackets();"><br>

<input type="button" value="det(A)" onclick="display_determinant(); display_brackets();">
<input type="button" value="inverse(A)&#8594;B" onclick="display_inverse(); display_brackets();">
<input type="button" value="transpose(A)&#8594;C" onclick="display_transpose(); display_brackets();"><br>

<input type="button" value="A.B&#8594;C" onclick="display_dot(data.textA.value,data.textB.value); display_brackets();">
<input type="button" value="B.A&#8594;C" onclick="display_dot(data.textB.value,data.textA.value); display_brackets();">
<input type="button" value="A.x&#8594;y" onclick="swap_textyC();display_dot(data.textA.value,data.textx.value);swap_textyC(); display_brackets();">&#8195;
<input type="button" value="A&#8596;C" onclick="swap_textAC();document.getElementById(&#39;sol&#39;).innerHTML=&#39;Swap the contents of A and C.&#39;; display_brackets();">
<input type="button" value="B&#8596;C" onclick="swap_textBC();document.getElementById(&#39;sol&#39;).innerHTML=&#39;Swap the contents of B and C.&#39;; display_brackets();">
<input type="button" value="x&#8596;y" onclick="swap_textxy();document.getElementById(&#39;sol&#39;).innerHTML=&#39;Swap the contents of x and y.&#39;; display_brackets();">
</p>

</form> 


<div align="center" id="sol"><p>LUP-decomposition determines a permutation matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1910" style="width: 0.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.053em, 1000.74em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-1911"><span class="mi" id="MathJax-Span-1912" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">P</script> that transforms <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1913" style="width: 0.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.738em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.001em, 1000.74em, 2.051em, -999.997em); top: -1.888em; left: 0em;"><span class="mrow" id="MathJax-Span-1914"><span class="mi" id="MathJax-Span-1915" style="font-family: MathJax_Math-italic;">A</span></span><span style="display: inline-block; width: 0px; height: 1.893em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">A</script> so that the equations are listed in the optimum order and calculates the corresponding upper and lower triangular matrices such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1916" style="width: 6.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.675em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.316em, 1005.67em, 2.366em, -999.997em); top: -2.203em; left: 0em;"><span class="mrow" id="MathJax-Span-1917"><span class="mi" id="MathJax-Span-1918" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span><span class="mo" id="MathJax-Span-1919" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="mi" id="MathJax-Span-1920" style="font-family: MathJax_Math-italic; padding-left: 0.213em;">A</span><span class="mo" id="MathJax-Span-1921" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mi" id="MathJax-Span-1922" style="font-family: MathJax_Math-italic; padding-left: 0.265em;">L</span><span class="mo" id="MathJax-Span-1923" style="font-family: MathJax_Main; padding-left: 0.213em;">&#8901;</span><span class="mi" id="MathJax-Span-1924" style="font-family: MathJax_Math-italic; padding-left: 0.213em;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.108em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.209em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo>&#8901;</mo><mi>A</mi><mo>=</mo><mi>L</mi><mo>&#8901;</mo><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">P\cdot A = L\cdot U</script>.</p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mo&gt;[&lt;/mo&gt;&lt;mtable rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;]&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;.&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="text-align: center; position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1925" style="width: 35.192em; display: inline-block;"><span style="display: inline-block; position: relative; width: 29.572em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.106em, 1029.47em, 6.62em, -999.997em); top: -4.094em; left: 0em;"><span class="mrow" id="MathJax-Span-1926"><span class="mrow" id="MathJax-Span-1927"><span class="mo" id="MathJax-Span-1928" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9121;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9123;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1929" style="padding-right: 0.16em; padding-left: 0.16em;"><span style="display: inline-block; position: relative; width: 4.992em; height: 0px;"><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1930"><span class="mrow" id="MathJax-Span-1931"><span class="mn" id="MathJax-Span-1932" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1942"><span class="mrow" id="MathJax-Span-1943"><span class="mn" id="MathJax-Span-1944" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1954"><span class="mrow" id="MathJax-Span-1955"><span class="mn" id="MathJax-Span-1956" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1966"><span class="mrow" id="MathJax-Span-1967"><span class="mn" id="MathJax-Span-1968" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 1.526em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1933"><span class="mrow" id="MathJax-Span-1934"><span class="mn" id="MathJax-Span-1935" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1945"><span class="mrow" id="MathJax-Span-1946"><span class="mn" id="MathJax-Span-1947" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1957"><span class="mrow" id="MathJax-Span-1958"><span class="mn" id="MathJax-Span-1959" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1969"><span class="mrow" id="MathJax-Span-1970"><span class="mn" id="MathJax-Span-1971" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 2.996em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1936"><span class="mrow" id="MathJax-Span-1937"><span class="mn" id="MathJax-Span-1938" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1948"><span class="mrow" id="MathJax-Span-1949"><span class="mn" id="MathJax-Span-1950" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1960"><span class="mrow" id="MathJax-Span-1961"><span class="mn" id="MathJax-Span-1962" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1972"><span class="mrow" id="MathJax-Span-1973"><span class="mn" id="MathJax-Span-1974" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 4.519em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1939"><span class="mrow" id="MathJax-Span-1940"><span class="mn" id="MathJax-Span-1941" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1951"><span class="mrow" id="MathJax-Span-1952"><span class="mn" id="MathJax-Span-1953" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1963"><span class="mrow" id="MathJax-Span-1964"><span class="mn" id="MathJax-Span-1965" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1975"><span class="mrow" id="MathJax-Span-1976"><span class="mn" id="MathJax-Span-1977" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span></span></span><span class="mo" id="MathJax-Span-1978" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9124;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9126;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-1979" style="padding-left: 0.16em;"><span class="mo" id="MathJax-Span-1980" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9121;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9123;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="mtable" id="MathJax-Span-1981" style="padding-right: 0.16em; padding-left: 0.16em;"><span style="display: inline-block; position: relative; width: 4.992em; height: 0px;"><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1982"><span class="mrow" id="MathJax-Span-1983"><span class="mn" id="MathJax-Span-1984" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1994"><span class="mrow" id="MathJax-Span-1995"><span class="mn" id="MathJax-Span-1996" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2006"><span class="mrow" id="MathJax-Span-2007"><span class="mn" id="MathJax-Span-2008" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2018"><span class="mrow" id="MathJax-Span-2019"><span class="mn" id="MathJax-Span-2020" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 1.526em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1985"><span class="mrow" id="MathJax-Span-1986"><span class="mn" id="MathJax-Span-1987" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1997"><span class="mrow" id="MathJax-Span-1998"><span class="mn" id="MathJax-Span-1999" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2009"><span class="mrow" id="MathJax-Span-2010"><span class="mn" id="MathJax-Span-2011" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2021"><span class="mrow" id="MathJax-Span-2022"><span class="mn" id="MathJax-Span-2023" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 2.996em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1988"><span class="mrow" id="MathJax-Span-1989"><span class="mn" id="MathJax-Span-1990" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2000"><span class="mrow" id="MathJax-Span-2001"><span class="mn" id="MathJax-Span-2002" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2012"><span class="mrow" id="MathJax-Span-2013"><span class="mn" id="MathJax-Span-2014" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2024"><span class="mrow" id="MathJax-Span-2025"><span class="mn" id="MathJax-Span-2026" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 4.519em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-1991"><span class="mrow" id="MathJax-Span-1992"><span class="mn" id="MathJax-Span-1993" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2003"><span class="mrow" id="MathJax-Span-2004"><span class="mn" id="MathJax-Span-2005" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2015"><span class="mrow" id="MathJax-Span-2016"><span class="mn" id="MathJax-Span-2017" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2027"><span class="mrow" id="MathJax-Span-2028"><span class="mn" id="MathJax-Span-2029" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span></span></span><span class="mo" id="MathJax-Span-2030" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9124;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9126;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2031" style="font-family: MathJax_Main; padding-left: 0.265em;">=</span><span class="mrow" id="MathJax-Span-2032" style="padding-left: 0.265em;"><span class="mo" id="MathJax-Span-2033" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9121;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9123;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2034" style="padding-right: 0.16em; padding-left: 0.16em;"><span style="display: inline-block; position: relative; width: 4.992em; height: 0px;"><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2035"><span class="mrow" id="MathJax-Span-2036"><span class="mn" id="MathJax-Span-2037" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2047"><span class="mrow" id="MathJax-Span-2048"><span class="mn" id="MathJax-Span-2049" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2059"><span class="mrow" id="MathJax-Span-2060"><span class="mn" id="MathJax-Span-2061" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2071"><span class="mrow" id="MathJax-Span-2072"><span class="mn" id="MathJax-Span-2073" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 1.526em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2038"><span class="mrow" id="MathJax-Span-2039"><span class="mn" id="MathJax-Span-2040" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2050"><span class="mrow" id="MathJax-Span-2051"><span class="mn" id="MathJax-Span-2052" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2062"><span class="mrow" id="MathJax-Span-2063"><span class="mn" id="MathJax-Span-2064" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2074"><span class="mrow" id="MathJax-Span-2075"><span class="mn" id="MathJax-Span-2076" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 2.996em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2041"><span class="mrow" id="MathJax-Span-2042"><span class="mn" id="MathJax-Span-2043" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2053"><span class="mrow" id="MathJax-Span-2054"><span class="mn" id="MathJax-Span-2055" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2065"><span class="mrow" id="MathJax-Span-2066"><span class="mn" id="MathJax-Span-2067" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2077"><span class="mrow" id="MathJax-Span-2078"><span class="mn" id="MathJax-Span-2079" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 4.519em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2044"><span class="mrow" id="MathJax-Span-2045"><span class="mn" id="MathJax-Span-2046" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2056"><span class="mrow" id="MathJax-Span-2057"><span class="mn" id="MathJax-Span-2058" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2068"><span class="mrow" id="MathJax-Span-2069"><span class="mn" id="MathJax-Span-2070" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2080"><span class="mrow" id="MathJax-Span-2081"><span class="mn" id="MathJax-Span-2082" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span></span></span><span class="mo" id="MathJax-Span-2083" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9124;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9126;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span class="mrow" id="MathJax-Span-2084" style="padding-left: 0.16em;"><span class="mo" id="MathJax-Span-2085" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9121;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9123;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9122;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span><span class="mtable" id="MathJax-Span-2086" style="padding-right: 0.16em; padding-left: 0.16em;"><span style="display: inline-block; position: relative; width: 5.78em; height: 0px;"><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 0em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2087"><span class="mrow" id="MathJax-Span-2088"><span class="mn" id="MathJax-Span-2089" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2099"><span class="mrow" id="MathJax-Span-2100"><span class="mn" id="MathJax-Span-2101" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2111"><span class="mrow" id="MathJax-Span-2112"><span class="mn" id="MathJax-Span-2113" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2124"><span class="mrow" id="MathJax-Span-2125"><span class="mn" id="MathJax-Span-2126" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 1.526em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2090"><span class="mrow" id="MathJax-Span-2091"><span class="mn" id="MathJax-Span-2092" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2102"><span class="mrow" id="MathJax-Span-2103"><span class="mn" id="MathJax-Span-2104" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2114"><span class="mrow" id="MathJax-Span-2115"><span class="mn" id="MathJax-Span-2116" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2127"><span class="mrow" id="MathJax-Span-2128"><span class="mn" id="MathJax-Span-2129" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1001.21em, 8.196em, -999.997em); top: -5.88em; left: 2.996em;"><span style="display: inline-block; position: relative; width: 1.263em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2093"><span class="mrow" id="MathJax-Span-2094"><span class="mn" id="MathJax-Span-2095" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2105"><span class="mrow" id="MathJax-Span-2106"><span class="mn" id="MathJax-Span-2107" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1001.21em, 4.257em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.628em;"><span class="mtd" id="MathJax-Span-2117"><span class="mrow" id="MathJax-Span-2118"><span class="mo" id="MathJax-Span-2119" style="font-family: MathJax_Main;">&#8722;</span><span class="mn" id="MathJax-Span-2120" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2130"><span class="mrow" id="MathJax-Span-2131"><span class="mn" id="MathJax-Span-2132" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span><span style="position: absolute; clip: rect(2.996em, 1000.48em, 8.196em, -999.997em); top: -5.88em; left: 5.255em;"><span style="display: inline-block; position: relative; width: 0.528em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -6.037em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2096"><span class="mrow" id="MathJax-Span-2097"><span class="mn" id="MathJax-Span-2098" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -4.619em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2108"><span class="mrow" id="MathJax-Span-2109"><span class="mn" id="MathJax-Span-2110" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.48em, 4.152em, -999.997em); top: -3.254em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2121"><span class="mrow" id="MathJax-Span-2122"><span class="mn" id="MathJax-Span-2123" style="font-family: MathJax_Main;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; clip: rect(3.154em, 1000.42em, 4.152em, -999.997em); top: -1.836em; left: 50%; margin-left: -0.26em;"><span class="mtd" id="MathJax-Span-2133"><span class="mrow" id="MathJax-Span-2134"><span class="mn" id="MathJax-Span-2135" style="font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span><span style="display: inline-block; width: 0px; height: 5.885em;"></span></span></span></span><span class="mo" id="MathJax-Span-2136" style="vertical-align: 2.839em;"><span style="display: inline-block; position: relative; width: 0.685em; height: 0px;"><span style="position: absolute; font-family: MathJax_Size4; top: -2.834em; left: 0em;">&#9124;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="position: absolute; font-family: MathJax_Size4; top: 0.58em; left: 0em;">&#9126;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.626em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -1.1em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span><span style="font-family: MathJax_Size4; position: absolute; top: -0.523em; left: 0em;">&#9125;<span style="display: inline-block; width: 0px; height: 3.994em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-2137" style="font-family: MathJax_Main; padding-left: 0.16em;">.</span></span><span style="display: inline-block; width: 0px; height: 4.099em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.872em; border-left: 0px solid; width: 0px; height: 6.316em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>=</mo><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mrow><mo>[</mo><mtable rowspacing="4pt" columnspacing="1em"><mtr><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd><mtd><mn>1</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mo>&#8722;</mo><mn>1</mn></mtd><mtd><mn>0</mn></mtd></mtr><mtr><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>0</mn></mtd><mtd><mn>1</mn></mtd></mtr></mtable><mo>]</mo></mrow><mo>.</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-78"> \begin{equation}\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&0&1\\0&0&1&0\end{bmatrix}\begin{bmatrix}1&0&1&0\\0&1&1&1\\1&0&1&1\\0&1&0&1\end{bmatrix}=\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&1&1&0\\1&0&0&1\end{bmatrix}\begin{bmatrix}1&0&1&0\\0&1&1&1\\0&0&-1&0\\0&0&0&1\end{bmatrix}. \nonumber\end{equation} </script></div>
</td></tr></tbody></table> <!-- end of black border -->



<p style="text-align:center"><input type="button" value="&#8592; Previous: LU decomposition " onclick="location=&#39;2.3.php&#39;"><input type="button" value="Next: Linear algebra libraries &#8594;" onclick="location=&#39;2.3b.php&#39;"></p>

<script>
load("userInput","targetFrame");
</script>

<!--




\subsection{Conditioning of a system of equations.}


\medskip

The solution of a linear set of equations calculated with a direct method
most of the times does not coincide exactly with the true solution, because:
\begin{itemize}
\item
During the calculation rounding errors can occur, and they can
accumulate leading to wrong results.
\item
Uncertainities in the input values can cause also
uncertainity in the solution.
\end{itemize}


\noindent
If small variations in the output data cause large variations in
the solution, one usually speaks of a {\it ill conditioned} system
(see Fig.\ref{a2.0}).

\begin{figure}
\epsfig{file=num2_fig/abb2_1.ps,scale=1.0}
\vspace*{0.1cm}
\caption{Good and ill-conditioned 2x2-System (from: [22], page 228).}
\label{a2.0}
\end{figure}

\noindent
The so-called {\it condition numbers} are practical ways 
to measure the quality of the solution
of a given linear system.

\vspace*{0.5cm}

\noindent
In the mathematical literature a variety of condition numbers 
have been discussed. The program LUDCMP 
performs the calculation of the so called {\it condition number of Hadamard}
for the matrix $A$, which is defined as: \cite{z2}

\[
K_{{\rm H}}(A)=\frac{\vert det(A)\vert}{\alpha_{1}\alpha_{2}\cdots\alpha_{n}}
\qquad\mbox{mit}\qquad
\alpha_{i} = \sqrt{a_{i1}^{2} + a_{i2}^{2} + \ldots +a_{in}^{2}}.
\]
For this number, the following empirical rules hold:
\begin{itemize}
\item
$K_{{\rm H}}(A) < 0.01$\qquad ill-conditioned,
\item
$K_{{\rm H}}(A) > 0.1$\qquad well-conditioned,
\item
$0.01 \leq K_{{\rm H}}(A) \leq 0.1$\qquad undefined.
\end{itemize}

\vspace*{1cm}



\subsection{The  program LUDCMP.}
\underline{Source}:  \cite{z4}, p. 38ff; \cite{numrecC}, p. 46ff
(with small changes). 


The program LUDCMP (LU DeCoMPosition) performs a LU-decomposition
of a real square matrix.

\medskip
\underline{INPUT Parameters}:
\begin{description}
\item[A( , ):] Matrix of coefficients of the linear system.

\item[N:] Order of the system = number of rows and columns of A.
\end{description}



\medskip


\underline{OUTPUT Parameters}:
\begin{description}
\item[A( , ):] 'LU Matrix' of the original matrix A (see remark 1 after the 
structure chart).
\item[INDX( ):] Indexing vector, which stores the line replacements
for the partial pivoting.
\item[D:] Determinant of the matrix of coefficients (see Section 2.3.6).
\item[KHAD:] Hadamard's condition number (See section 2.3.2).
\end{description}


\newpage

\nassiwidth=15cm
\scriptsize
\STRUCT{Structure chart 3}{LUDCMP(A,N,INDX,D,KHAD)}{%
  \ACTION{KHAD:=1.0}%
  \WHILE{I=1(1)N}{%
    \ACTION{SUM:=0.0}%
    \WHILE{J=1(1)N}{%
      \ACTION{SUM:=SUM + A(I,J)**2}%
    }%
    \ENDWHILE%
    \ACTION{KHAD:=KHAD*SQRT(SUM)}%
  }%
  \ENDWHILE%
  \ACTION{D:=1.0}%
  \WHILE{J=1(1)N}{%
    \WHILE{I=1(1)J-1}{%
      \ACTION{SUM:=A(I,J)}%
      \WHILE{K=1(1)I-1}{%
        \ACTION{SUM:=SUM-A(I,K)*A(K,J)}%
      }%
      \ENDWHILE%
      \ACTION{A(I,J):=SUM}%
    }%
    \ENDWHILE%
    \ACTION{AAMAX:=0.0}%
    \WHILE{I=J(1)N}{%
      \ACTION{SUM:=A(I,J)}%
      \WHILE{K=1(1)J-1}{%
        \ACTION{SUM:=SUM-A(I,K)*A(K,J)}%
      }%
      \ENDWHILE%
      \ACTION{A(I,J):=SUM \quad DUM:=$\vert$ SUM$\vert$}%  
      \IF{DUM $\ge$ AAMAX}%
      \THEN{%
        \ACTION{IMAX:=I \quad AAMAX:=DUM}%
      }%
      \ELSE{%
        \ACTION{......}%
      }%
      \ENDIF%
    }%
    \ENDWHILE%
    \IF{J $\ne$ IMAX}%
    \THEN{%
      \WHILE{K=1(1)N}{%
        \ACTION{DUM:=A(IMAX,K) \\ A(IMAX,K):=A(J,K) \\ A(J,K):=DUM}%
      }%
      \ENDWHILE%
      \ACTION{D:=--D}%
    }%
    \ELSE{%
      \ACTION{......}%
    }%
    \ENDIF%
    \ACTION{INDX(J):=IMAX}%
    \IF{A(J,J) = 0.0}%
    \THEN{%
      \ACTION{A(J,J):=TINY}%
    }%
    \ELSE{%
      \ACTION{......}%
    }%
    \ENDIF%
  }%
  \ENDWHILE%
}%

\newpage

\STRUCT{.}{.}{%
  \WHILE{.}{%
    \ACTION{DUM:=1.0/A(J,J)}%
    \WHILE{I=J+1(1)N}{%
      \ACTION{A(I,J):=A(I,J)*DUM}%
    }%
    \ENDWHILE%
    \ACTION{D:=D*A(J,J)}%
  }%
  \ENDWHILE%
  \ACTION{KHAD:=$\vert$ D $\vert$/KHAD}%
  \ACTION{(return)}%
}%  
\normalsize

\vspace*{0.5cm}


\underline{Remarks on the program LUDCMP}:

\medskip

\begin{enumerate}
\item In order to save memory, the coefficients of the LU
matrix are stored successively on the corresponding memory location
of the original matrix A. This has however the disadvantage that
the original matrix is lost. In case one wants to reuse the
matrix A for other calculations, this has to be saved in another array
{\bf before}
\newline
executing LUDCMP.
\item The output parameter D is used for the calculation of
the determinant of A.
\item In \cite{z4}, the constant TINY is set to $10^{-20}$.
As it is clear from the structure chart 3, this constant prevents the
program from crashing in case one of the divisors of (\ref{lin8})
becomes exactly zero. This is explained in section 2.5. 
\item In \cite{z4} the matrix coefficients
are scaled row-wise for the pivot search.
The optimal scaling of a linear system represents a surprisingly complicated
problem (see for example \cite{z3}, page 140 ff and \cite{z6}, page 41ff).
These references also discuss the scaling of the program we have
presented here.
\end{enumerate}

\newpage

\subsection{The sub-program LUBKSB}


\underline{Source}: \cite{z4}, page 39; \cite{numrecC}, page 47
(with changes).

The program LUBKSB (LU BacKSuBstitution) calculates the solution 
\vec{x} of the system $LU\vec{x}=\vec{b}$ using equations
(\ref{lin10} - \ref{lin13}).

\medskip
\underline{INPUT parameters}:
\begin{description}
\item[A( , ):] LU-Matrix of the matrix of coefficients,  
calculated for example from program LUDCMP.
\item[N:] Order of the system = rows and columns of A.
\item[INDX( ):] Indexing vector, which contains information
about the rows exchange performed in LUDCMP.
\item[B( ):] inhomogeneous vector of the system.
\end{description}

\underline{OUTPUT parameters}:
\begin{description}
\item[X( ):] Solution vector.
\end{description}

\underline{Internal vector}:
\begin{description}
\item[Y( ):] .
\end{description}

\newpage

\STRUCT{Structure chart 4}{LUBKSB(A,N,INDX,B,X)}{%
  \WHILE{I=1(1)N}{%
    \ACTION{BB(I):=B(I)}%
  }%
  \ENDWHILE%
  \WHILE{I=1(1)N}{%
    \ACTION{LL:=INDX(I) \\ SUM:=BB(LL) \\ BB(LL):=BB(I)}%
    \WHILE{J=1(1)I-1}{%
      \ACTION{SUM:=SUM-A(I,J)*Y(J)}%
    }%
    \ENDWHILE%
    \ACTION{Y(I):=SUM}%
  }%
  \ENDWHILE%
  \WHILE{I=N(-1)1}{%
    \ACTION{SUM:=Y(I)}%
    \WHILE{J=I+1(1)N}{%
      \ACTION{SUM:=SUM-A(I,J)*X(J)}%
    }%
    \ENDWHILE%
    \ACTION{X(I):=SUM/A(I,I)}%
  }%
  \ENDWHILE%
  \ACTION{(return)}%
}%

\newpage


 


\subsection{Examples for the programs LUDCMP and LUBKSB.}
Let us consider the square $4 \times 4$ matrix with (four rows and 
four columns):
\begin{displaymath}
A=\left( \begin{array}{cccc}
1.1161 & 0.1254 & 0.1397 & 0.1490 \\
0.1582 & 1.1675 & 0.1768 & 0.1871 \\
0.1968 & 0.2071 & 1.2168 & 0.2271 \\
0.2368 & 0.2471 & 0.2568 & 1.2671 \end{array} \right)
\end{displaymath}

\medskip
\noindent The condition number is $K_{{\rm H}}$ = 0.752, i.e. the
system is {\it well conditioned!}

\begin{itemize}
\item What is the solution  $\vec{x}$
of the linear inhomogeneous system
\begin{displaymath}
A \cdot \vec{x} = (-1.8367, 1.1944, 3.2368, -0.7232)^{T} \quad ?
\end{displaymath}

The numerical result is exact up to machine precision:
\begin{displaymath}
\vec{x}=(-.2000000E+01, 0.1000000E+01, 0.3000000E+01, -.1000000E+01)^{T}
\end{displaymath}

%\newpage

\item What is the  matrix inverse of $A$?

The numerical result is exact almost up to machine precision 
(up to max two units in the seventh digit after the comma) and reads:

\begin{verbatim}

Inverted Matrix:

   .9379443E+00   -.6843720E-01   -.7960770E-01   -.8592076E-01
  -.8852433E-01    .9059826E+00   -.9919081E-01   -.1055899E+00
  -.1113511E+00   -.1169667E+00    .8784252E+00   -.1270733E+00
  -.1354557E+00   -.1401826E+00   -.1438075E+00    .8516058E+00

Test Matrix:

   .9999999E+00    .1126516E-07    .2518815E-08   -.1120211E-08
  -.4888310E-08    .1000000E+01   -.6621389E-08   -.3829147E-08
  -.2647183E-08    .5092004E-08    .9999999E+00    .1665558E-07
   .7356128E-08   -.1727934E-07   -.1442864E-07    .1000000E+01

\end{verbatim}
The test matrix contains the result of the multiplication: original
matrix times inverted  matrix. 
Ideally, this should be the identity matrix.


\item What is the determinat of $A$?
  
The numerical result (exact up to machine precision) is
\begin{displaymath}
\mbox{Determinant} = 0.1758306E+01
\end{displaymath}
\end{itemize}

\newpage


\section{Iterative improvement of the solution.}
It is clear that the accuracy of the numerical solution of a linear set
of equations is limited by the machine precision. In many cases unfortunately
we cannot attain this level of precision due to the accumulation of rounding
errors.

In these cases we still have the possibility of {\em improving iteratively} 
the
numerical solution. We will now briefly explain the (very simple)
theory underlying this idea.

\medskip

\noindent
Let us suppose that the numerical solution of the system:

\begin{displaymath}
A \cdot \vec{x}=\vec{b}
\end{displaymath}
is the vector $\bar\vec{x}=
\vec{x} + \delta\vec{x}$, which is affected by a rounding error.
If we now re-insert $\bar\vec{x}$ in the system of equations,
we obtain a different inhomogeneous vector $\vec{b}+\delta\vec{b}$, due
to the rounding error;
%
\[
A\cdot \bar\vec{x} = A(\vec{x}+\delta\vec{x}) = \vec{b}+\delta\vec{b}
\]
and
\[
\underbrace{(A\vec{x}-\vec{b})}_{=0} + A\cdot \delta\vec{x} = 
\delta\vec{b}\,.
\]

We have thus an error vector $\delta\vec{x}$,
which is the solution of the system

\begin{displaymath}
A \cdot {\bf \delta x} = {\bf \delta b} \quad ,
\end{displaymath}
where $A$ is the {\em original} matrix of coefficients and ${\bf \delta b}$
is the so-called {\em residual vector} $A \bar\vec{x}-\vec{b}$.
\medskip

\noindent
The structure chart 5 illustrates how to solve
a linear system with
iterative improvement of the solution:
\[ \vec{x} = \bar \vec{x} - \delta \vec{x}\quad .\]

\medskip

\noindent
A few more \underline{remarks}:

%%% QUI
\begin{enumerate}
\item Since the first time that LUDCMP is called the matrix $A$ is
destroyed, it is important to store the corresponding 
information somewhere before. 
\item Due to the big risk of a {\em subtractive cancellation} 
the calculation of the residual vector should be performed in
double precision, if possible.
\item Some software libraries (for example NAG) contain programs for
the solution of inhomogeneous linear equations which already
include a method for iterative improvement.
\end{enumerate}

\newpage

\footnotesize
\STRUCT{Structure chart 5}{Iterative improvement of the solution.}
{%
  \WHILE{I=1(1)N}{%
    \WHILE{J=1(1)N}{%
      \ACTION{ASP(I,J):=A(I,J)}%
    }%
    \ENDWHILE%
  }%
  \ENDWHILE%
  \PROC{A,N,INDX,D,KHAD}{LUDCMP}%
  \PROC{A,N,INDX,B,X}{LUBKSB}%
  \REPEAT{%
    \WHILE{I=1(1)N}{%
      \ACTION{SUMDP:=-B(I)}%
      \WHILE{J=1(1)N}{%
        \ACTION{SUMDP:=SUMDP + DBLE(ASP(I,J))*DBLE(X(J))}%
      }%
      \ENDWHILE%
      \ACTION{RES(I):=SUMDP}%
    }%
    \ENDWHILE%
    \PROC{A,N,INDX,RES,DELX}{LUBKSB}%
    \WHILE{I=1(1)N}{%
      \ACTION{X(I):=X(I)-DELX(I)}%
    }%
    \ENDWHILE%
  }%
  \UNTIL{(Condition, under which the iterative method should stop)}
  \ACTION{(Result and return)}
}%
\normalsize  
 
\section{Rounding errors in ill-conditioned and singular systems.} 

The method of partial pivoting 
permits a substantial reduction of the 
rounding errors which occur in the gaussian method. However,
in {\em ill-conditioned} systems the numerical solution
can still be seriously affected by errors, as we show in the following example:


\newpage

\begin{verbatim}

0.10000E+01 0.50000E+00 0.33333E+00 0.25000E+00 0.20000E+00   0.228333E+01

0.50000E+00 0.33333E+00 0.25000E+00 0.20000E+00 0.16667E+00   0.145000E+01

0.33333E+00 0.25000E+00 0.20000E+00 0.16667E+00 0.14286E+00   0.109286E+01

0.25000E+00 0.20000E+00 0.16667E+00 0.14286E+00 0.12500E+00   0.884530E+00

0.20000E+00 0.16667E+00 0.14286E+00 0.12500E+00 0.11111E+00   0.745640E+00

\end{verbatim}

\noindent
The matrix of coefficients is a {\em Hilbert matrix} of fifth order,
with components rounded at the fifth significant digit:

\[
a_{ij}=\frac{1}{i+j-1}
\]
and the inhomogeneous vector is chosen so that the exact solution is

\begin{displaymath}
x_{1}=x_{2}=x_{3}=x_{4}=x_{5}=1.
\end{displaymath}

The condition number is $K_{{\rm H}}$ = 0.55$\cdot
10^{-10}$; i.e. this is a very ill-conditioned system, and we can
expect to encounter many difficulties!

\bigskip

\noindent
In the following table, we compare 
the exact 
and the numerical result 
$\bar\vec{x}$ (FORTRAN, single precision).
We also show the vector $A \cdot \bar\vec{x}$:

\vspace*{0.25cm}

\begin{tabular}{ccc}
\hline
$\vec{x}$ (exact) & $\bar\vec{x}$ (numerical) & $A \cdot \bar\vec{x}$ \\
\hline
1. & 0.9999459E+00 & 0.2283330E+01 \\
1. & 0.1000955E+01 & 0.1450000E+01 \\
1. & 0.9960009E+00 & 0.1092860E+01 \\
1. & 0.1005933E+01 & 0.8845300E+00 \\
1. & 0.9971328E+00 & 0.7456400E+00 \\
\hline
\end{tabular}

\vspace*{0.25cm}

\noindent
The problem is clear: although some components of the 
numerical vector deviate considerably from the exact solution,
the linear system of equations is still satisfied!
Re-iteration doesn't improve the solution.


This example illustrates one of the most important problems 
in the use of numerical methods in linear systems.
Despite several theoretical attempts (see for example
\cite{z6} page 109 ff) there is no easy, general way to avoid 
that the components of the solution are affected by rounding errors.

\medskip

Another unpleasant consequence of the rounding error is that in a numerical 
calculation it is practically impossible to discriminate between 
{\em singular} or {\em almost singular} problems. 
%
In the program a matrix is considered singular if all the elements
of a pivot column are exactly zero. However,
since these elements themselves are produced by an  
arithmetical operation, we
could have elements that are not exactly zero
due to rounding errors, {\em even if the matrix of coefficients is singular}.
According to \cite{z6}, page 63:


\medskip

\noindent
{\em The situation is particularly unfortunate, because the
strong mathematical difference between singular and non-singular
matrices exists only in the ideal world of mathematicians.
As soon as we work with matrices in rounded arithmetics, the difference
becomes necessarily much less clear-cut. Some non-singular matrices
could become singular as a result of small perturbations introduced
by rounding errors. It is even more likely that a genuine singular matrix
is transformed into a similar, non-singular one.}


\medskip

For this reason many programs avoid giving a definition of singularity
and leave the choice to the user.
\newline The program LUDCMP actually checks whether 
some diagonal elements $\gamma_{jj}$ are exactly(!) zero, but
only to avoid a division by zero in this (very unlikely) event!


\section{Methods for direct solution of systems with special 
matrix of coefficients.}
Since direct methods for linear systems 
are relatively expensive in terms of computational time and storage,
many practical applications employ algorithms that are especially
designed to exploit specific properties of the matrix
of coefficients, if present.

\subsection{Solution of systems of equations with tridiagonal matrices 
of coefficients.}

Many important numerical methods (for example the spline interpolation)
lead to linear sets of equations of the form

\begin{equation}\label{lin15}
\left( \begin{array}{cccccc}
b_{1} & c_{1} & 0 & 0 & \cdots & 0 \\
a_{2} & b_{2} & c_{2} & 0 & \cdots & 0 \\
0 & a_{3} & b_{3} & c_{3} & \cdots & 0 \\
. &&&&& . \\
. &&&&& . \\
. &&&&& c_{n-1} \\
0 & 0 & 0 & 0 & \cdots & b_{n} \end{array} \right)
\left( \begin{array}{c}
x_{1} \\ x_{2} \\ x_{3} \\ . \\ . \\ . \\ x_{n} \end{array} \right)
= \left( \begin{array}{c} r_{1} \\ r_{2} \\ r_{3} \\ . \\ . \\ . \\ r_{n}
\end{array} \right)
\end{equation}
where the {\em tridiagonal} matrix of coefficients
can clearly be rewritten in terms 
of the three vectors $\vec{b}$ (main diagonal),
${\bf a}$ and ${\bf c}$ (lower and upper secondary diagonal).
In this case, if we use the LU-decomposition (\underline{without} pivoting),
we obtain the following structure: 

 
\begin{displaymath}
\left( \begin{array}{ccccc}
1 & 0 & 0 & \cdots & 0 \\
m_{2} & 1 & 0 & \cdots & 0 \\
0 & m_{3} & 1 & \cdots & 0 \\
. & & & & . \\
. & & & & . \\
. & & & & . \\
0 & 0 & 0 & \cdots & 1 \end{array} \right)
\underbrace{\left( \begin{array}{ccccc}
u_{1} & c_{1} & 0 & \cdots & 0 \\
0 & u_{2} & c_{2} & \cdots & 0 \\
. & & & & . \\
. & & & & . \\
. & & & & c_{n-1} \\
0 & 0 & 0 & \cdots & u_{n} \end{array} \right) \left( \begin{array}{c}
x_{1} \\ x_{2} \\ . \\ . \\ . \\ x_{n} \end{array} \right)}_{\equiv
\vec{y}} =
\left( \begin{array}{c} r_{1} \\ r_{2} \\ . \\ . \\ . \\ r_{n} \end{array}
\right)
\end{displaymath}
which leads to the following simple expressions, through
Eqs. (\ref{lin5}-\ref{lin13}):


\begin{eqnarray}\label{lin16}
u_{1} & = & b_{1} \nonumber\\
y_{1} & = & r_{1} \nonumber\\ \nonumber\\ 
m_{j} & = & a_{j}/u_{j-1} \nonumber\\
u_{j} & = & b_{j} - m_{j} \cdot c_{j-1} \qquad j=2,\ldots,n \\
y_{j} & = & r_{j} - m_{j} \cdot y_{j-1} \nonumber
\end{eqnarray}
The components of the solution can then be obtained through 
a back substitution:

\begin{eqnarray}\label{lin17}
x_{n} & = & y_{n}/u_{n} \nonumber\\
x_{j} & = & (y_{j} - c_{j} \cdot x_{j+1})/u_{j} \qquad j=n-1,\ldots,1
\end{eqnarray}
The following program exploits these expressions.
\subsection{The program TRID.}
\underline{Source}: \cite{z4}, p. 43 (with changes)

\medskip
The program TRID calculates the solution of a linear, inhomogeneous
set of equations with a tridiagonal matrix of coefficients.

\medskip

\underline{INPUT parameters}:

\begin{description}
\item[A( ),B( ),C( ):] Vectors of the tridiagonal matrix.
\item[R( ):] Inhomogeneous vector.
\item[N:] Order of the system.
\end{description}



\underline{OUTPUT parameters}:

\begin{description}
\item[X( ):] Solution vector.
\end{description}

\underline{Internal vectors}:
\begin{description}
\item[U( ), Y( ):] . 
\end{description}

\bigskip

\newpage

\STRUCT{Structure chart 6}{TRID(A,B,C,R,N,X)}{%
  \ACTION{Y(1):=R(1) \\ U(1):=B(1)}%
  \IF{U(1) = 0.0}%
  \THEN{%
    \ACTION{(Exit with error message!)}%
  }%
  \ELSE{%
    \ACTION{......}%
  }%
  \ENDIF%
  \WHILE{J=2(1)N}{%
    \ACTION{M:=A(J)/U(J-1) \\ U(J):=B(J)-M*C(J-1)}%
    \IF{U(J) = 0.0}%
    \THEN{%
      \ACTION{(Exit with error message!)}%
    }%
    \ELSE{%
      \ACTION{......}%
    }%
    \ENDIF%
    \ACTION{Y(J):=R(J)-M*Y(J-1)}%
  }%
  \ENDWHILE%
  \ACTION{X(N):=Y(N)/U(N)}%
  \WHILE{J=N-1(-1)1}{%
    \ACTION{X(J):=(Y(J)-C(J)*X(J+1))/U(J)}%
  }%
  \ENDWHILE%
  \ACTION{(return)}%
}%

\newpage

\underline{Remarks on the TRID program}:


\begin{enumerate}
\item The main advantage of TRID is obviously a clear reduction
of storage space, since as input information we have to provide
only the four one-dimensional vectors A, B, C and R.
The program also uses the four one-dimensional internal vectors U, Y,
and the solution vector X.
In a problem of n-th order this means that the storage space is of order
$7n$. For comparison, the cost of a normal LU method is of
order $n^{2}+n$.
\item A further advantage compared to the normal LU method is the
largely reduced computational cost.
\item On the other hand, not using pivoting means that the method
may be aborted also in case of {\em non-singular} problems! 
In principle it would be possible to introduce pivoting 
also in the program TRID, but in this way the size of the matrix would
increase (and in particularly unfavourable case even double).
%
It can be shown, however,
that this problem does not occur 
 in the so-called {\em diagonal-dominant} tridiagonal matrices.
These matrices have the property that 
$\mid b_{j} \mid > \mid a_{j} \mid + \mid c_{j} \mid$ for all
$j=1,\ldots,n$.
This property is important, because many of the tridiagonal
matrices that are encountered in practice 
are {\em diagonal-dominant}!

\item Many software libraries contain programs for the solution of
linear sets of equations with tridiagonal matrices of coefficients:
see for example \cite{z2}, p. 304 and \cite{z4}, p.42.
\end{enumerate}


\subsection{Other special forms of the matrix of coefficients.}

In the literature we can find a large number of algorithms and programs
designed to treat specific linear systems, whose matrix
of coefficients have special structures. In particular, we refer the
reader to \cite{z2} and \cite{z4}, where he/she can find information
on the following themes: symmetrical matrices (Cholesky-decomposition),
cyclic-tridiagonal matrices, general band matrices, block matrices, ...

-->


</td></tr></tbody></table>

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>